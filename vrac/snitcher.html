<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Hub Citoyen - Organisez votre action</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg: #0a0e27;
      --surface: #151b3d;
      --primary: #3b82f6;
      --secondary: #10b981;
      --text: #e2e8f0;
      --text-muted: #94a3b8;
      --border: #1e293b;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 1rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Header */
    header {
      text-align: center;
      padding: 2rem 0 3rem;
      border-bottom: 1px solid var(--border);
    }

    h1 {
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .tagline {
      color: var(--text-muted);
      font-size: 1.1rem;
      margin-bottom: 1.5rem;
    }

    .quick-stats {
      display: flex;
      gap: 2rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 1.5rem;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* Navigation Tabs */
    .tabs {
      display: flex;
      gap: 0.5rem;
      margin: 2rem 0;
      overflow-x: auto;
      padding-bottom: 0.5rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
      font-size: 0.95rem;
      flex-shrink: 0;
    }

    .tab:hover {
      background: var(--primary);
      border-color: var(--primary);
    }

    .tab.active {
      background: var(--primary);
      border-color: var(--primary);
    }

    /* Content Sections */
    .section {
      display: none;
      animation: fadeIn 0.3s;
    }

    .section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Cards Grid */
    .cards {
      display: grid;
      gap: 1.5rem;
      margin-top: 2rem;
    }

    @media (min-width: 768px) {
      .cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 1024px) {
      .cards {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-4px);
      border-color: var(--primary);
      box-shadow: 0 8px 24px rgba(59, 130, 246, 0.15);
    }

    .card-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .card-desc {
      color: var(--text-muted);
      font-size: 0.95rem;
      margin-bottom: 1rem;
    }

    .card-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: rgba(59, 130, 246, 0.1);
      color: var(--primary);
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 500;
    }

    .card-badge.green {
      background: rgba(16, 185, 129, 0.1);
      color: var(--secondary);
    }

    /* Action Buttons */
    .actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.95rem;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: #2563eb;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: transparent;
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    /* Table */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1.5rem;
      background: var(--surface);
      border-radius: 8px;
      overflow: hidden;
    }

    .data-table th {
      background: rgba(59, 130, 246, 0.1);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      border-bottom: 1px solid var(--border);
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .data-table tr:hover {
      background: rgba(59, 130, 246, 0.05);
    }

    /* Chess Board */
    .chess-board {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 2px;
      max-width: 500px;
      margin: 2rem auto;
      aspect-ratio: 1;
    }

    .chess-cell {
      background: var(--surface);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(1.5rem, 3vw, 2rem);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .chess-cell:hover {
      background: var(--primary);
      transform: scale(1.05);
    }

    .chess-cell.light { background: #334155; }
    .chess-cell.dark { background: #1e293b; }

    .coord {
      position: absolute;
      bottom: 2px;
      right: 4px;
      font-size: 0.6rem;
      color: var(--text-muted);
    }

    /* Search */
    .search-box {
      width: 100%;
      padding: 1rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 1rem;
      margin-bottom: 1.5rem;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--primary);
    }

    /* Footer */
    footer {
      margin-top: 4rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      padding: 1rem;
      overflow-y: auto;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 2rem 1.5rem;
      max-width: 500px;
      width: 100%;
    }

    .modal-header {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--text);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text);
      font-weight: 500;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 0.75rem;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 1rem;
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
      font-family: inherit;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary);
    }

    .modal-actions {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .badge-citoyen { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    .badge-systeme { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .badge-neutre  { background: rgba(148, 163, 184, 0.2); color: #94a3b8; }

    .action-btn {
      padding: 0.5rem;
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      transition: transform 0.2s;
    }

    .action-btn:hover {
      transform: scale(1.2);
    }

    /* Hub PNJ / JSON ‚Äì iframes */
    .iframe-shell {
      margin-top: 1.5rem;
      background: var(--surface);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 0.75rem;
    }

    .iframe-shell-header {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .iframe-shell-inner {
      position: relative;
      width: 100%;
      padding-top: 65%; /* ratio responsive */
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--border);
      background: #020617;
    }

    .iframe-shell-inner iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .iframe-note {
      margin-top: 0.6rem;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Modules / Multivers */
    .module-grid {
      display: grid;
      gap: 1.2rem;
      margin-top: 1.5rem;
    }

    @media (min-width: 768px) {
      .module-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .module-card {
      background: var(--surface);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 1rem;
    }

    .module-card h3 {
      font-size: 1.05rem;
      margin-bottom: 0.4rem;
    }

    .module-card p {
      font-size: 0.86rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .module-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.35rem;
    }

    .module-link {
      font-size: 0.8rem;
      padding: 0.25rem 0.7rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text);
      text-decoration: none;
      white-space: nowrap;
    }

    .module-link:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .module-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.4rem;
    }

    a {
      color: var(--primary);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üéØ Hub Citoyen</h1>
      <p class="tagline">
        Organisez vos actions, g√©rez vos donn√©es, cartographiez les acteurs ‚Äì et branchez
        vos modules (tests, QG PNJ, multivers‚Ä¶)
      </p>

      <div class="quick-stats">
        <div class="stat">
          <div class="stat-number" id="totalActors">0</div>
          <div class="stat-label">Acteurs</div>
        </div>
        <div class="stat">
          <div class="stat-number" id="totalActions">0</div>
          <div class="stat-label">Cases strat√©giques</div>
        </div>
        <div class="stat">
          <div class="stat-number" id="totalDocs">0</div>
          <div class="stat-label">Fiches / notes</div>
        </div>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab active" data-tab="overview">Vue d'ensemble</button>
      <button class="tab" data-tab="actors">Acteurs</button>
      <button class="tab" data-tab="chess">Cartographie</button>
      <button class="tab" data-tab="pnj">QG PNJ</button>
      <button class="tab" data-tab="intel">Intel JSON</button>
      <button class="tab" data-tab="modules">Modules / Multivers</button>
      <button class="tab" data-tab="export">Export</button>
    </nav>

    <!-- Overview Section -->
    <div class="section active" id="overview">
      <div class="cards">
        <div class="card" onclick="switchTab('actors')">
          <div class="card-icon">üë•</div>
          <h3 class="card-title">Gestion des Acteurs</h3>
          <p class="card-desc">
            Cr√©ez et g√©rez les fiches des personnes, organisations et institutions.
          </p>
          <span class="card-badge">Essentiel</span>
        </div>

        <div class="card" onclick="switchTab('chess')">
          <div class="card-icon">‚ôüÔ∏è</div>
          <h3 class="card-title">Cartographie Strat√©gique</h3>
          <p class="card-desc">
            Visualisez les rapports de force sur un √©chiquier interactif (coh√©rent avec vos PNJ).
          </p>
          <span class="card-badge green">Visuel</span>
        </div>

        <div class="card" onclick="switchTab('pnj')">
          <div class="card-icon">üß©</div>
          <h3 class="card-title">QG des PNJ</h3>
          <p class="card-desc">
            Fichier central de fichage (qg.html) ‚Äì PNJ, acteurs, organisations, export Markdown/JSON.
          </p>
          <span class="card-badge">Central</span>
        </div>

        <div class="card" onclick="switchTab('intel')">
          <div class="card-icon">üß¨</div>
          <h3 class="card-title">Interface Intel JSON</h3>
          <p class="card-desc">
            Module intel-hq.html : lecture avanc√©e du JSON (fiches PNJ & co), comme un Prysm de poche.
          </p>
          <span class="card-badge green">Analyse</span>
        </div>

        <div class="card" onclick="switchTab('modules')">
          <div class="card-icon">üß†</div>
          <h3 class="card-title">Tests & Multivers</h3>
          <p class="card-desc">
            Portail vers SAS, tests de recrutement, examens, vortex, jeux de fichage, etc.
          </p>
          <span class="card-badge">ARG / P√©dago</span>
        </div>

        <div class="card" onclick="switchTab('export')">
          <div class="card-icon">üì§</div>
          <h3 class="card-title">Export & Cl√© USB</h3>
          <p class="card-desc">
            Export JSON / Markdown / HTML pour embarquer votre instance sur cl√© USB ou GitHub.
          </p>
          <span class="card-badge green">Portable</span>
        </div>
      </div>
    </div>

    <!-- Actors Section -->
    <div class="section" id="actors">
      <input type="text" class="search-box" placeholder="üîç Rechercher un acteur..." id="searchActors" oninput="filterActors()">

      <div class="actions">
        <button class="btn btn-primary" onclick="showActorModal()">‚ûï Nouvel Acteur</button>
        <button class="btn btn-secondary" onclick="importActors()">üì• Importer JSON</button>
        <button class="btn btn-secondary" onclick="clearAllActors()">üóëÔ∏è Tout effacer</button>
      </div>

      <table class="data-table">
        <thead>
          <tr>
            <th>Nom</th>
            <th>R√¥le</th>
            <th>Camp</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="actorsTable">
          <tr>
            <td colspan="4" style="text-align: center; color: var(--text-muted); padding: 2rem;">
              Aucun acteur enregistr√©. Cliquez sur "Nouvel Acteur" pour commencer.
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Chess Section -->
    <div class="section" id="chess">
      <div class="chess-board" id="chessBoard"></div>
      <div style="text-align: center; margin-top: 1rem; color: var(--text-muted); font-size:0.9rem;">
        Cliquez sur une case pour y placer un symbole (acteur, enjeu, dossier‚Ä¶).
        <br>Utilisez la m√™me coordonn√©e (ex. E4) dans <strong>qg.html</strong> pour lier PNJ & √©chiquier.
      </div>
    </div>

    <!-- QG PNJ Section -->
    <div class="section" id="pnj">
      <h2 style="font-size:1.2rem; margin-bottom:0.4rem;">üß© QG des PNJ (qg.html)</h2>
      <p style="font-size:0.9rem; color:var(--text-muted);">
        Ce module est ton fichier central de fichage : PNJ, acteurs, organisations, institutions.
        Il permet d‚Äôexporter toutes les fiches en <strong>Markdown</strong> ou <strong>JSON</strong>
        (utilisable ensuite dans <code>intel-hq.html</code> et dans ce Hub).
      </p>

      <div class="actions" style="margin-top:0.8rem;">
        <button class="btn btn-primary" type="button" onclick="openQGInNewTab()">
          üîó Ouvrir qg.html dans un nouvel onglet
        </button>
        <button class="btn btn-secondary" type="button" onclick="reloadQGIframe()">
          ‚ôªÔ∏è (Re)charger qg.html ci-dessous
        </button>
      </div>

      <div class="iframe-shell">
        <div class="iframe-shell-header">
          <span>Instance embarqu√©e de <code>qg.html</code> (si le fichier est dans le m√™me dossier).</span>
          <span style="font-size:0.8rem; color:var(--text-muted);">üí° Sur t√©l√©phone, le plein √©cran (onglet s√©par√©) sera souvent plus confortable.</span>
        </div>
        <div class="iframe-shell-inner">
          <iframe id="qgFrame" src="qg.html" title="QG PNJ"></iframe>
        </div>
        <p class="iframe-note">
          ‚ùó Si rien ne s‚Äôaffiche : v√©rifie que <code>qg.html</code> est bien pr√©sent √† c√¥t√© de ce fichier
          sur ta cl√© USB / dans ton repo, ou ouvre-le directement dans un autre onglet.
        </p>
      </div>
    </div>

    <!-- Intel JSON Section -->
    <div class="section" id="intel">
      <h2 style="font-size:1.2rem; margin-bottom:0.4rem;">üß¨ Interface de renseignement JSON (intel-hq.html)</h2>
      <p style="font-size:0.9rem; color:var(--text-muted);">
        Ce module sert √† lire en profondeur tes exports JSON : par exemple le
        <code>fiches-pnj-qg.json</code> g√©n√©r√© par <code>qg.html</code>, ou tout autre tableau d‚Äôobjets.
        Filtrage, stats, fiche d√©taill√©e + JSON brut, fa√ßon mini ‚ÄúPrysm / NSA maison‚Äù mais
        <strong>100% local</strong>.
      </p>

      <div class="actions" style="margin-top:0.8rem;">
        <button class="btn btn-primary" type="button" onclick="openIntelInNewTab()">
          üîó Ouvrir intel-hq.html dans un nouvel onglet
        </button>
        <button class="btn btn-secondary" type="button" onclick="reloadIntelIframe()">
          ‚ôªÔ∏è (Re)charger intel-hq.html ci-dessous
        </button>
      </div>

      <div class="iframe-shell">
        <div class="iframe-shell-header">
          <span>Instance embarqu√©e de <code>intel-hq.html</code> pour les analyses JSON.</span>
          <span style="font-size:0.8rem; color:var(--text-muted);">
            üëâ Importe ici le JSON export√© depuis <code>qg.html</code> ou ce Hub (<code>hub-citoyen-export.json</code>).
          </span>
        </div>
        <div class="iframe-shell-inner">
          <iframe id="intelFrame" src="intel-hq.html" title="Intel JSON HQ"></iframe>
        </div>
        <p class="iframe-note">
          ‚ùó Si la zone reste vide : assure-toi que le fichier <code>intel-hq.html</code> est bien
          pr√©sent dans le m√™me dossier que ce Hub.
        </p>
      </div>
    </div>

    <!-- Modules / Multivers Section -->
    <div class="section" id="modules">
      <h2 style="font-size:1.2rem; margin-bottom:0.4rem;">üß† Portail Modules & Multivers</h2>
      <p style="font-size:0.9rem; color:var(--text-muted);">
        Cette section fait office de <strong>plan de multivers</strong> : chaque lien pointe
        vers un fichier HTML de ton kit (cl√© USB, d√©p√¥t GitHub‚Ä¶).  
        Tu peux renommer / adapter les fichiers, tant que tu mets √† jour les liens.
      </p>

      <div class="module-grid">
        <div class="module-card">
          <h3>üéì SAS & tests de recrutement</h3>
          <p>
            Entr√©e g√©n√©rale et tests pour savoir si tu veux / peux rentrer dans l‚ÄôOrganisation,
            comprendre la d√©marche, et t‚Äôauto-filtrer.
          </p>
          <div class="module-links">
            <a href="SAS.html" class="module-link" target="_blank">SAS (porte d‚Äôentr√©e)</a>
            <a href="test-index.html" class="module-link" target="_blank">Index des tests</a>
            <a href="exam.html" class="module-link" target="_blank">Examen g√©n√©ral</a>
          </div>
          <p class="module-note">
            Place ces fichiers √† c√¥t√© du Hub pour que les liens fonctionnent. Tu peux en ajouter d‚Äôautres (test-0, test-1‚Ä¶).
          </p>
        </div>

        <div class="module-card">
          <h3>üåÄ Vortex & strat√©gie globale</h3>
          <p>
            Vision d‚Äôensemble de ton instance, de ses briques, et des niveaux de jeu (citoyennet√©,
            veille, multivers, Mordor‚Ä¶).
          </p>
          <div class="module-links">
            <a href="vortex.html" class="module-link" target="_blank">vortex.html</a>
            <a href="power.html" class="module-link" target="_blank">power.html</a>
            <a href="linux.html" class="module-link" target="_blank">linux.html (√©conomie du libre)</a>
          </div>
          <p class="module-note">
            Utile pour expliquer le projet √† quelqu‚Äôun de z√©ro tout en le reliant √† la crypto, au libre, etc.
          </p>
        </div>

        <div class="module-card">
          <h3>üéÆ Jeux de fichage & cashflow</h3>
          <p>
            Jeux type ‚Äúqui-est-ce‚Äù, fichage de marques, produits, services, budget, cashback ‚Äì pour
            gamifier le rapport au financement.
          </p>
          <div class="module-links">
            <a href="mission-1.html" class="module-link" target="_blank">mission-1.html</a>
            <a href="cashback.html" class="module-link" target="_blank">cashback.html</a>
            <a href="browniz-politik.html" class="module-link" target="_blank">browniz-politik.html</a>
          </div>
          <p class="module-note">
            Ces fichiers illustrent les m√©caniques de dons, sponsoring, contreparties et doutes l√©gitimes.
          </p>
        </div>

        <div class="module-card">
          <h3>üï∑Ô∏è Conspi, Mordor & Sharky</h3>
          <p>
            Le miroir tordu : la Conspi, S., Sharky, le portail ‚Äúyohoo‚Äù, Sauron, etc.  
            Sert √† montrer la face obscure tout en la d√©samor√ßant.
          </p>
          <div class="module-links">
            <a href="conspii.html" class="module-link" target="_blank">conspii.html</a>
            <a href="faq-o0-yohoo.html" class="module-link" target="_blank">faq-o0-yohoo.html</a>
            <a href="s.html" class="module-link" target="_blank">s.html</a>
            <a href="sharky.html" class="module-link" target="_blank">sharky.html</a>
          </div>
          <p class="module-note">
            Ces pages sont optionnelles mais utiles pour jouer avec la peur, la satire et la prise de distance.
          </p>
        </div>

        <div class="module-card">
          <h3>‚ôüÔ∏è Fichage tactique & PNJ</h3>
          <p>
            Int√©gration avec le QG PNJ (<code>qg.html</code>), l‚Äô√©chiquier, et l‚Äôinterface JSON
            (<code>intel-hq.html</code>).
          </p>
          <div class="module-links">
            <a href="qg.html" class="module-link" target="_blank">qg.html (QG PNJ)</a>
            <a href="intel-hq.html" class="module-link" target="_blank">intel-hq.html (JSON HQ)</a>
            <a href="chess-vortex.html" class="module-link" target="_blank">chess-vortex.html</a>
          </div>
          <p class="module-note">
            Tu peux r√©utiliser les JSON g√©n√©r√©s dans <code>intel-hq.html</code>, ce Hub, ou un futur backend.
          </p>
        </div>

        <div class="module-card">
          <h3>üì° Instances & d√©ploiement</h3>
          <p>
            Tout ce qui touche aux instances (cl√© USB, GitHub Pages, Vercel, VPS), aux FAQ techniques
            et √† la r√©plication du kit.
          </p>
          <div class="module-links">
            <a href="faq-tech.html" class="module-link" target="_blank">faq-tech.html</a>
            <a href="readme.html" class="module-link" target="_blank">readme.html (instance locale)</a>
            <a href="readme-mastodon.html" class="module-link" target="_blank">readme-mastodon.html</a>
          </div>
          <p class="module-note">
            Ces pages expliquent comment quelqu‚Äôun peut cr√©er sa propre instance sans te demander
            la permission.
          </p>
        </div>
      </div>

      <p class="module-note" style="margin-top:1.1rem;">
        üí° Tu peux adapter ces liens √† ce que tu as r√©ellement sur ta cl√© / ton d√©p√¥t.  
        Le Hub reste simplement un <strong>tableau de bord</strong> qui pointe vers tes univers.
      </p>
    </div>

    <!-- Export Section -->
    <div class="section" id="export">
      <div class="actions">
        <button class="btn btn-primary" onclick="exportJSON()">üì¶ Exporter JSON (instance compl√®te)</button>
        <button class="btn btn-secondary" onclick="exportMarkdown()">üìÑ Exporter Markdown (rapport)</button>
        <button class="btn btn-secondary" onclick="exportHTML()">üåê Exporter HTML (rapport visuel)</button>
      </div>

      <div style="margin-top: 2rem; padding: 1.5rem; background: var(--surface); border-radius: 8px;">
        <h3 style="margin-bottom: 1rem;">Aper√ßu de l'export</h3>
        <textarea id="exportPreview"
          style="width: 100%; min-height: 300px; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 1rem; border-radius: 8px; font-family: monospace;"
          readonly></textarea>
      </div>

      <p class="module-note" style="margin-top:0.8rem;">
        Tu peux ensuite r√©importer le JSON dans <code>intel-hq.html</code> pour le diss√©quer,
        ou l‚Äôembarquer dans une autre instance du Hub.
      </p>
    </div>

    <footer>
      <p>Hub Citoyen ‚Äì Donn√©es stock√©es localement dans votre navigateur</p>
      <p style="margin-top: 0.5rem; font-size: 0.85rem;">
        Version 1.0 ‚Äì Mobile First ‚Äì Pens√© pour tourner sur une simple cl√© USB + un navigateur.
      </p>
    </footer>
  </div>

  <!-- Actor Modal -->
  <div class="modal" id="actorModal">
    <div class="modal-content">
      <h2 class="modal-header" id="modalTitle">Nouvel Acteur</h2>
      <form id="actorForm" onsubmit="saveActor(event)">
        <input type="hidden" id="actorId">

        <div class="form-group">
          <label class="form-label">Nom *</label>
          <input type="text" class="form-input" id="actorName" required>
        </div>

        <div class="form-group">
          <label class="form-label">R√¥le</label>
          <input type="text" class="form-input" id="actorRole" placeholder="Ex: √âlu local, Journaliste...">
        </div>

        <div class="form-group">
          <label class="form-label">Camp</label>
          <select class="form-select" id="actorCamp">
            <option value="citoyen">Citoyen / Alli√©</option>
            <option value="systeme">Syst√®me / Adversaire</option>
            <option value="neutre">Neutre / Zone grise</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Tags (s√©par√©s par des virgules)</label>
          <input type="text" class="form-input" id="actorTags" placeholder="Ex: veille, local, √©ducation">
        </div>

        <div class="form-group">
          <label class="form-label">Notes</label>
          <textarea class="form-textarea" id="actorNotes" placeholder="Informations compl√©mentaires..."></textarea>
        </div>

        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
          <button type="button" class="btn btn-secondary" onclick="closeModal()">‚ùå Annuler</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Data Storage
    const STORAGE_KEY = 'citizenHub_v1';
    let appData = {
      actors: [],
      chessBoard: {},
      lastUpdated: null
    };

    // Initialize
    function init() {
      loadData();
      updateStats();
      renderChessBoard();
      renderActorsTable();
      setupTabs();
    }

    // Tab Navigation
    function setupTabs() {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          const tabName = tab.dataset.tab;
          switchTab(tabName);
        });
      });
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

      const tabEl = document.querySelector(`[data-tab="${tabName}"]`);
      const sectionEl = document.getElementById(tabName);
      if (tabEl) tabEl.classList.add('active');
      if (sectionEl) sectionEl.classList.add('active');
    }

    // Data Management
    function loadData() {
      const stored = localStorage.getItem(STORAGE_KEY);
      if (stored) {
        try {
          appData = JSON.parse(stored);
        } catch (e) {
          console.warn('Erreur JSON sur les donn√©es stock√©es, r√©initialisation.', e);
          appData = { actors: [], chessBoard: {}, lastUpdated: null };
        }
      }
    }

    function saveData() {
      appData.lastUpdated = new Date().toISOString();
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
      } catch (e) {
        console.warn('Impossible de sauvegarder les donn√©es dans localStorage.', e);
      }
      updateStats();
    }

    function updateStats() {
      document.getElementById('totalActors').textContent = appData.actors.length;
      document.getElementById('totalActions').textContent =
        Object.keys(appData.chessBoard).filter(k => appData.chessBoard[k]).length;
      document.getElementById('totalDocs').textContent =
        appData.actors.filter(a => a.notes && a.notes.trim()).length;
    }

    // Chess Board
    function renderChessBoard() {
      const board = document.getElementById('chessBoard');
      board.innerHTML = '';

      const cols = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
      const rows = [8, 7, 6, 5, 4, 3, 2, 1];

      rows.forEach((row, rIdx) => {
        cols.forEach((col, cIdx) => {
          const coord = col + row;
          const isLight = (rIdx + cIdx) % 2 === 0;
          const cell = document.createElement('div');
          cell.className = `chess-cell ${isLight ? 'light' : 'dark'}`;
          cell.innerHTML = `
            ${appData.chessBoard[coord] || ''}
            <span class="coord">${coord}</span>
          `;
          cell.onclick = () => editCell(coord);
          board.appendChild(cell);
        });
      });
    }

    function editCell(coord) {
      const emoji = prompt(`Placer un symbole sur ${coord}:`, appData.chessBoard[coord] || '');
      if (emoji !== null) {
        appData.chessBoard[coord] = emoji;
        saveData();
        renderChessBoard();
      }
    }

    // Actor Management
    function showActorModal(actorId = null) {
      const modal = document.getElementById('actorModal');
      const form = document.getElementById('actorForm');
      form.reset();

      if (actorId) {
        const actor = appData.actors.find(a => a.id === actorId);
        if (actor) {
          document.getElementById('modalTitle').textContent = 'Modifier l\'acteur';
          document.getElementById('actorId').value = actor.id;
          document.getElementById('actorName').value = actor.name;
          document.getElementById('actorRole').value = actor.role || '';
          document.getElementById('actorCamp').value = actor.camp || 'neutre';
          document.getElementById('actorTags').value = (actor.tags || []).join(', ');
          document.getElementById('actorNotes').value = actor.notes || '';
        }
      } else {
        document.getElementById('modalTitle').textContent = 'Nouvel Acteur';
      }

      modal.classList.add('active');
    }

    function closeModal() {
      document.getElementById('actorModal').classList.remove('active');
    }

    function saveActor(event) {
      event.preventDefault();

      const idVal = document.getElementById('actorId').value;
      const actor = {
        id: idVal ? parseInt(idVal, 10) : Date.now(),
        name: document.getElementById('actorName').value,
        role: document.getElementById('actorRole').value,
        camp: document.getElementById('actorCamp').value,
        tags: document.getElementById('actorTags').value
          .split(',')
          .map(t => t.trim())
          .filter(Boolean),
        notes: document.getElementById('actorNotes').value,
        updatedAt: new Date().toISOString()
      };

      if (idVal) {
        const index = appData.actors.findIndex(a => a.id === parseInt(idVal, 10));
        if (index !== -1) {
          appData.actors[index] = actor;
        }
      } else {
        actor.createdAt = new Date().toISOString();
        appData.actors.push(actor);
      }

      saveData();
      renderActorsTable();
      closeModal();
    }

    function renderActorsTable() {
      const tbody = document.getElementById('actorsTable');

      if (!appData.actors.length) {
        tbody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; color: var(--text-muted); padding: 2rem;">
              Aucun acteur enregistr√©. Cliquez sur "Nouvel Acteur" pour commencer.
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = appData.actors.map(actor => {
        const campClass = actor.camp || 'neutre';
        return `
          <tr>
            <td><strong>${actor.name}</strong></td>
            <td>${actor.role || '-'}</td>
            <td><span class="card-badge badge-${campClass}">${getCampLabel(actor.camp)}</span></td>
            <td>
              <button class="action-btn" onclick="showActorModal(${actor.id})" title="Modifier">‚úèÔ∏è</button>
              <button class="action-btn" onclick="deleteActor(${actor.id})" title="Supprimer">üóëÔ∏è</button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function getCampLabel(camp) {
      const labels = {
        'citoyen': 'Citoyen',
        'systeme': 'Syst√®me',
        'neutre': 'Neutre'
      };
      return labels[camp] || 'Neutre';
    }

    function deleteActor(id) {
      if (confirm('Supprimer cet acteur ?')) {
        appData.actors = appData.actors.filter(a => a.id !== id);
        saveData();
        renderActorsTable();
      }
    }

    function clearAllActors() {
      if (confirm('Supprimer TOUS les acteurs ? Cette action est irr√©versible.')) {
        appData.actors = [];
        saveData();
        renderActorsTable();
      }
    }

    function filterActors() {
      const search = document.getElementById('searchActors').value.toLowerCase();
      const rows = document.querySelectorAll('#actorsTable tr');

      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        // On √©vite de masquer une √©ventuelle ligne "aucun acteur"
        if (row.querySelector('td[colspan]')) return;
        row.style.display = text.includes(search) ? '' : 'none';
      });
    }

    function importActors() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json,application/json';
      input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            const data = JSON.parse(event.target.result);
            if (Array.isArray(data)) {
              appData.actors = data;
            } else if (data.actors && Array.isArray(data.actors)) {
              appData.actors = data.actors;
            } else {
              throw new Error('Format JSON invalide (attendu: tableau ou { actors: [...] }).');
            }
            saveData();
            renderActorsTable();
            alert('‚úÖ Donn√©es import√©es avec succ√®s !');
          } catch (err) {
            alert('‚ùå Erreur lors de l\'import : ' + err.message);
          }
        };
        reader.readAsText(file);
      };
      input.click();
    }

    // Export Functions
    function exportJSON() {
      const dataStr = JSON.stringify(appData, null, 2);
      document.getElementById('exportPreview').value = dataStr;
      downloadFile('hub-citoyen-export.json', dataStr, 'application/json');
    }

    function exportMarkdown() {
      let md = '# Hub Citoyen - Export\n\n';
      md += `üìÖ Date: ${new Date().toLocaleDateString('fr-FR')}\n\n`;

      md += `## üìä Statistiques\n\n`;
      md += `- **Acteurs enregistr√©s**: ${appData.actors.length}\n`;
      md += `- **Cases √©chiquier occup√©es**: ${Object.keys(appData.chessBoard).filter(k => appData.chessBoard[k]).length}\n\n`;

      if (appData.actors.length > 0) {
        md += `## üë• Liste des Acteurs\n\n`;

        const groupedByCamp = {
          citoyen: [],
          systeme: [],
          neutre: []
        };

        appData.actors.forEach(actor => {
          groupedByCamp[actor.camp || 'neutre'].push(actor);
        });

        Object.entries(groupedByCamp).forEach(([camp, actors]) => {
          if (actors.length > 0) {
            md += `### ${getCampLabel(camp)}\n\n`;
            actors.forEach(actor => {
              md += `#### ${actor.name}\n\n`;
              if (actor.role) md += `- **R√¥le**: ${actor.role}\n`;
              if (actor.tags && actor.tags.length > 0) md += `- **Tags**: ${actor.tags.join(', ')}\n`;
              if (actor.notes) md += `- **Notes**: ${actor.notes}\n`;
              md += `\n`;
            });
          }
        });
      }

      if (Object.keys(appData.chessBoard).some(k => appData.chessBoard[k])) {
        md += `## ‚ôüÔ∏è √âchiquier Strat√©gique\n\n`;
        md += '```\n';
        const cols = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
        const rows = [8, 7, 6, 5, 4, 3, 2, 1];

        rows.forEach(row => {
          const line = cols.map(col => {
            const coord = col + row;
            return appData.chessBoard[coord] || '¬∑';
          }).join(' ');
          md += `${row} ${line}\n`;
        });
        md += '  ' + cols.join(' ') + '\n';
        md += '```\n\n';
      }

      md += `---\n\n`;
      md += `*G√©n√©r√© par Hub Citoyen*\n`;

      document.getElementById('exportPreview').value = md;
      downloadFile('hub-citoyen-export.md', md, 'text/markdown');
    }

    function exportHTML() {
      const actorsCount = appData.actors.length;
      const chessCount = Object.keys(appData.chessBoard).filter(k => appData.chessBoard[k]).length;

      let html = `<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hub Citoyen - Export ${new Date().toLocaleDateString('fr-FR')}</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 800px; margin: 0 auto; padding: 2rem; background: #0a0e27; color: #e2e8f0; }
    h1, h2, h3 { color: #3b82f6; }
    .actor { background: #151b3d; padding: 1rem; margin: 1rem 0; border-radius: 8px; border-left: 4px solid #3b82f6; }
    .badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.85rem; }
    .badge-citoyen { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    .badge-systeme { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .badge-neutre { background: rgba(148, 163, 184, 0.2); color: #94a3b8; }
    .chess-board { display: grid; grid-template-columns: repeat(8, 40px); gap: 2px; margin: 1rem 0; }
    .chess-cell { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; background: #1e293b; }
  </style>
</head>
<body>
  <h1>üéØ Hub Citoyen - Export</h1>
  <p>üìÖ ${new Date().toLocaleDateString('fr-FR')} √† ${new Date().toLocaleTimeString('fr-FR')}</p>

  <h2>üìä Statistiques</h2>
  <ul>
    <li>Acteurs enregistr√©s: <strong>${actorsCount}</strong></li>
    <li>Cases √©chiquier: <strong>${chessCount}</strong></li>
  </ul>

  <h2>üë• Acteurs</h2>`;

      appData.actors.forEach(actor => {
        html += `
  <div class="actor">
    <h3>${actor.name}</h3>
    ${actor.role ? `<p><strong>R√¥le:</strong> ${actor.role}</p>` : ''}
    <p><span class="badge badge-${actor.camp || 'neutre'}">${getCampLabel(actor.camp)}</span></p>
    ${actor.tags && actor.tags.length ? `<p><strong>Tags:</strong> ${actor.tags.join(', ')}</p>` : ''}
    ${actor.notes ? `<p>${actor.notes}</p>` : ''}
  </div>`;
      });

      if (chessCount > 0) {
        html += `
  <h2>‚ôüÔ∏è √âchiquier</h2>
  <div class="chess-board">`;

        const cols = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
        const rows = [8, 7, 6, 5, 4, 3, 2, 1];

        rows.forEach(row => {
          cols.forEach(col => {
            const coord = col + row;
            html += `<div class="chess-cell">${appData.chessBoard[coord] || ''}</div>`;
          });
        });

        html += `
  </div>`;
      }

      html += `
  <hr>
  <p><small>G√©n√©r√© par Hub Citoyen</small></p>
</body>
</html>`;

      document.getElementById('exportPreview').value = html;
      downloadFile('hub-citoyen-export.html', html, 'text/html');
    }

    function downloadFile(filename, content, mimeType) {
      const blob = new Blob([content], { type: mimeType });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }

    // Int√©gration QG & Intel ‚Äì helpers
    function openQGInNewTab() {
      window.open('qg.html', '_blank');
    }

    function reloadQGIframe() {
      const frame = document.getElementById('qgFrame');
      if (frame) frame.src = 'qg.html';
    }

    function openIntelInNewTab() {
      window.open('intel-hq.html', '_blank');
    }

    function reloadIntelIframe() {
      const frame = document.getElementById('intelFrame');
      if (frame) frame.src = 'intel-hq.html';
    }

    // Initialize on load
    init();
  </script>
</body>
</html>
